# Weiler-Atherton 算法测试指南

## 算法说明

Weiler-Atherton 算法是一种多边形裁剪算法，可以处理凹多边形和产生多个结果多边形。

## 测试步骤

### 步骤 1：绘制多边形

1. 点击菜单：**绘图** → **多边形（右键结束）**
2. 在画布上依次点击鼠标左键，定义多边形的顶点（至少3个）
3. 点击鼠标右键结束多边形绘制
4. 多边形会被绘制并保存

**建议测试的多边形：**
- 简单三角形（3个顶点）
- 简单四边形（4个顶点）
- 五边形或六边形（5-6个顶点）

### 步骤 2：执行 Weiler-Atherton 裁剪

1. 点击菜单：**裁剪** → **多边形裁剪** → **Weiler-Atherton算法**
2. 点击鼠标左键定义裁剪窗口的第一个角点
3. 移动鼠标到对角位置（应该看到红色虚线预览）
4. 再次点击鼠标左键完成裁剪窗口定义
5. 程序会自动执行裁剪并显示结果

### 步骤 3：查看结果

裁剪完成后会显示消息框，包含：
- 处理的多边形数量
- 结果多边形数量

## 预期行为

### 情况 1：多边形完全在裁剪窗口内
- **结果**：多边形保持不变
- **消息**：Processed: 1, Result: 1

### 情况 2：多边形完全在裁剪窗口外
- **结果**：多边形被移除
- **消息**：Processed: 1, Result: 0

### 情况 3：多边形部分在裁剪窗口内
- **结果**：只保留在窗口内的部分
- **消息**：Processed: 1, Result: 1（或更多）

## 测试案例

### 测试案例 1：简单三角形裁剪

1. 绘制一个三角形，顶点坐标大约为：
   - (100, 100)
   - (300, 100)
   - (200, 300)

2. 定义裁剪窗口：
   - 左上角：(150, 150)
   - 右下角：(250, 250)

3. **预期结果**：三角形被裁剪，只保留在窗口内的部分

### 测试案例 2：矩形裁剪

1. 绘制一个矩形多边形，顶点坐标大约为：
   - (50, 50)
   - (350, 50)
   - (350, 350)
   - (50, 350)

2. 定义裁剪窗口：
   - 左上角：(100, 100)
   - 右下角：(300, 300)

3. **预期结果**：矩形被裁剪成一个较小的矩形

### 测试案例 3：五边形裁剪

1. 绘制一个五边形，顶点坐标大约为：
   - (200, 50)
   - (350, 150)
   - (300, 300)
   - (100, 300)
   - (50, 150)

2. 定义裁剪窗口：
   - 左上角：(150, 100)
   - 右下角：(250, 250)

3. **预期结果**：五边形被裁剪，保留在窗口内的部分

## 常见问题

### Q1：为什么裁剪后没有结果？
**可能原因：**
1. 多边形完全在裁剪窗口外
2. 多边形顶点数少于3个
3. 多边形是自相交的（算法可能无法正确处理）

**解决方法：**
- 确保多边形至少部分在裁剪窗口内
- 绘制简单的凸多边形进行测试

### Q2：为什么结果多边形看起来不对？
**可能原因：**
1. 多边形顶点顺序不正确（应该是逆时针或顺时针一致）
2. 多边形有自相交
3. 裁剪窗口太小

**解决方法：**
- 绘制简单的凸多边形
- 确保裁剪窗口足够大
- 按照一致的方向绘制多边形顶点

### Q3：程序崩溃或卡死怎么办？
**可能原因：**
1. 算法进入无限循环
2. 内存泄漏

**解决方法：**
- 重启程序
- 使用更简单的测试案例
- 报告具体的操作步骤

## 算法限制

当前实现的限制：
1. **只支持矩形裁剪窗口**（这是最常见的情况）
2. **最适合凸多边形**（凹多边形可能产生意外结果）
3. **不支持自相交多边形**
4. **最大迭代次数限制为1000**（防止无限循环）

## 与 Sutherland-Hodgman 的对比

| 特性 | Sutherland-Hodgman | Weiler-Atherton |
|------|-------------------|-----------------|
| 裁剪窗口 | 凸多边形 | 任意多边形 |
| 被裁剪多边形 | 凸多边形 | 凸或凹多边形 |
| 结果数量 | 最多1个 | 可能多个 |
| 算法复杂度 | 简单 | 复杂 |
| 稳定性 | 高 | 中等 |

## 调试建议

如果遇到问题：

1. **从简单开始**：先测试简单的三角形或四边形
2. **检查顶点顺序**：确保多边形顶点按照一致的方向绘制
3. **避免边界情况**：不要让多边形顶点正好在裁剪窗口边界上
4. **使用较大的裁剪窗口**：确保有明显的交集
5. **清空画布重试**：使用"文件" → "新建"清空画布

## 成功标志

算法正常工作的标志：
- ✅ 能够绘制多边形并保存
- ✅ 能够定义裁剪窗口（看到红色虚线预览）
- ✅ 裁剪完成后显示统计信息
- ✅ 裁剪结果符合预期（在窗口内的部分被保留）
- ✅ 画布正确刷新显示结果

## 报告问题

如果算法仍然无法工作，请提供：
1. 具体的操作步骤
2. 多边形的顶点坐标
3. 裁剪窗口的坐标
4. 预期结果 vs 实际结果
5. 是否有错误消息或程序崩溃

---

**最后更新：** 2024-11-28
