# 视角控制功能测试说明 (View Control Test Instructions)

## 功能概述
视角控制模式允许用户通过鼠标拖动来旋转3D场景的观察视角。

## 测试步骤

### 1. 切换到3D模式
- 点击菜单 **模式(M)** → **3D模式(3)**
- 窗口应显示蓝色背景的3D场景

### 2. 创建测试图形
- 点击菜单 **3D图形(3)** → **立方体(U)**
- 在窗口中点击鼠标左键创建一个立方体
- 可以创建多个图形以便更好地观察视角变化

### 3. 进入视角控制模式
- 点击菜单 **3D控制(O)** → **视角控制(V)**
- 此时进入视角控制模式

### 4. 测试视角旋转
- **水平旋转**: 按住鼠标左键并左右拖动，场景应该绕Y轴旋转
- **垂直旋转**: 按住鼠标左键并上下拖动，场景应该绕X轴旋转
- 垂直旋转角度被限制在 -89° 到 89° 之间，防止视角翻转

### 5. 快捷方式测试
- 在任何3D模式下，按住 **Ctrl** 键并拖动鼠标也可以旋转视角
- 这提供了一种不需要切换模式的快捷视角控制方式

## 预期结果
- ✅ 点击"视角控制"菜单后，系统进入视角控制模式
- ✅ 拖动鼠标时，场景实时旋转
- ✅ 视角变化后，所有3D图形的显示位置相应更新
- ✅ 垂直旋转角度被限制，不会出现视角翻转

## 相关需求
- **Requirement 4.1**: 用户点击"视角控制"菜单项进入视角控制模式
- **Requirement 4.2**: 处于视角控制模式时拖动鼠标旋转摄像机视角
- **Requirement 4.4**: 视角改变时实时更新场景渲染

## 技术实现
- 摄像机使用球坐标系统，通过 `angleX` (水平角) 和 `angleY` (垂直角) 控制
- 摄像机位置根据角度和距离计算：
  ```
  cameraX = targetX + distance * cos(angleY) * cos(angleX)
  cameraY = targetY + distance * sin(angleY)
  cameraZ = targetZ + distance * cos(angleY) * sin(angleX)
  ```
- 鼠标移动灵敏度为 0.5 度/像素
